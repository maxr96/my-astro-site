---
import { SITE_TITLE, SITE_DESCRIPTION } from '../config';
import BaseLayout from '../layouts/BaseLayout.astro';
import type { MarkdownInstance } from 'astro';
import HeroPost from '../components/HeroPost.astro';

type PostType = {
  slug: string
  title: string
  date: string
  coverImage: string
  excerpt: string
  ogImage: {
    url: string
  }
  content: string,
  tags: string
}

// Use Astro.glob() to fetch all posts, and then sort them by date.
const posts = (await Astro.glob<MarkdownInstance<PostType>>('./posts/*.{md,mdx}')).sort(
	(a, b) => new Date(b.frontmatter.date).valueOf() - new Date(a.frontmatter.date).valueOf()
);
const heroPost = posts[0];
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
	<HeroPost 
		title={heroPost.frontmatter.title} 
		coverImage={heroPost.frontmatter.coverImage}
		date={heroPost.frontmatter.date}
		slug={heroPost.frontmatter.slug}
		excerpt={heroPost.frontmatter.excerpt}
	/>
</BaseLayout>